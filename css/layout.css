/* quick early-hide hook:
   an inline script (below) sets html[data-default-tuner-visible] BEFORE paint,
   so we can hide tuner elements if the default is false and avoid any flicker.
*/
html[data-default-tuner-visible="false"] .tuner-floating,
html[data-default-tuner-visible="false"] #tunerToggle {
  display: none !important;
}

/* Mobile-first base */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  background-color: var(--bg-primary);  /* removed gradient to avoid banding */
  color:var(--text-primary);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  line-height:1.45;
  overflow-x:hidden;
  -webkit-overflow-scrolling:touch;
}

/* default: hide desktop nav-links (header will only show title + hamburger) */
.nav-links { display: none; }

/* App wrapper */
.app{
  min-height:100vh;
  position:relative;
  padding-top:var(--nav-height);
  display:flex;
  flex-direction:column;
  align-items:center;
}

/* NAV */
.nav{
  --h:var(--nav-height);
  position:fixed;
  top:0;left:0;right:0;height:var(--h);
  display:flex;align-items:center;justify-content:space-between;
  padding:8px 14px;z-index:1200;pointer-events:auto; /* <-- nav topmost */
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  background-color: rgba(7,13,22,var(--glass-alpha)); /* solid translucent */
  box-shadow: 0 6px 18px rgba(0,0,0,0.35);
}
.brand{display:flex;gap:10px;align-items:center}
.brand h1{font-size:16px;margin:0;color:var(--heading-primary);letter-spacing:0.2px}
.top-config{
  display:flex;
  gap:10px;
  align-items:center;
  margin-left:8px;
  color:rgba(255,255,255,0.85);
  font-size:13px;
}

/* --- TIDY: hide debug/top-config in desktop to keep header clean --- */
.top-config { display:none; }

/* Tuner toggle in nav - hidden when default-tuner-visible is false */
.tuner-toggle-btn{
  display:flex;align-items:center;gap:8px;padding:6px 8px;border-radius:10px;border:0;background:transparent;color:var(--text-primary);cursor:pointer;
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  border:1px solid rgba(255,255,255,0.03);
}

/* Hamburger button styling */
.hamburger{display:flex;align-items:center;gap:8px}
.hamburger button{
  display:flex;align-items:center;justify-content:center;width:44px;height:44px;border-radius:10px;border:0;
  background:transparent;
  color:var(--text-primary);cursor:pointer;
  transition:transform var(--transition-fast) ease;
}
.hamburger button:active{transform:scale(0.98)}
.hamburger svg {
  stroke: var(--text-primary);
}

/* Mobile menu sheet — now positioned under nav on the right */
.menu-sheet{
  position:fixed;
  top:calc(var(--nav-height) + 12px);
  right:12px;
  width:260px;
  max-width:calc(100% - 24px);
  padding:12px;border-radius:var(--menu-border-radius);
  background: var(--menu-bg);
  box-shadow: var(--menu-shadow);
  z-index:1100; /* <-- above overlay, below nav */
  display:none;flex-direction:column;gap:8px;
  /* no backdrop-filter on the menu itself — overlay will blur the page behind it */
  border: 1px solid rgba(255,255,255,0.03);
}
.menu-sheet a{
  display:block;
  padding:var(--menu-item-padding);
  border-radius:var(--menu-item-border-radius);
  text-decoration:none;
  color:rgba(255,255,255,0.92);
  font-size:14px
}
.menu-sheet a:hover{background:var(--menu-item-hover-bg)}

/* Full-screen overlay that blurs everything behind (including content) */
.menu-overlay{
  position:fixed;
  inset:0;
  z-index:1000; /* <-- between content and menu */
  display:none;
  background: rgba(10,12,15,0.18); /* subtle dim */
  backdrop-filter: blur(var(--menu-blur));
  -webkit-backdrop-filter: blur(var(--menu-blur));
  pointer-events:auto;
}

/* Three.js canvas behind content */
#three-wrap{position:fixed;inset:0;z-index:0;pointer-events:none}

/* Section base */
.section{
  width:100%;
  max-width:var(--max-content-width);
  padding:18px;
  margin:18px 12px;
  background: rgba(10,12,15, calc(var(--section-alpha) * 1));
  border-radius:12px;
  z-index:50;
  backdrop-filter: blur(var(--section-blur));
  -webkit-backdrop-filter: blur(var(--section-blur));
  /* NEW: Border styling */
  border: var(--section-border-width) solid var(--section-border-color);
}
.section h3{margin:6px 0 10px 0;color:var(--heading-primary);font-size:18px}
.section p{margin:0 0 10px 0;color:rgba(255,255,255,0.92);font-size:14px}

/* --- EXTRA: add space between header and first content section (equal to header height) --- */
.section:first-of-type {
  margin-top: calc(var(--nav-height) + 12px);
}

/* Main content container (explicitly below overlay) */
main#mainContent { z-index:90; position:relative; }

/* Spacer element - size is set in JS to pixel height (no vh) */
.section-spacer{
  width:100%;
  height:0; /* filled dynamically using JS to avoid vh-related jumps */
  background:transparent;
  pointer-events:none;
  border: none;
  outline: none;
}

/* Responsive: Hide nav items on narrow screens; menu will be used */
@media (max-width:820px){
  .nav-links{display:none}
}

/* Hide tuner button if tuner is set to not be visible (JS sets data-visible attr) */
.tuner-toggle-btn[data-visible="false"] {
  display: none !important;
}

/* Link styles (global, non-underlined) */
a {
  color: var(--link-color);
  text-decoration: none;
  transition: color var(--transition-fast) ease;
}
a:hover, a:focus {
  color: var(--link-hover-color);
  text-decoration: none; /* explicitly no underline */
}
a:visited { color: var(--link-visited-color); }
/* put near other layout rules (layout.css) */
:root {
  /* if you already have --max-content-width in variables.css, remove this or keep same value */
  --max-content-width: 980px;
}

/* make sure the content container centers its children */
#mainContent,
#mainContentArea,
#secondaryPagesContainer {
  display: flex;               /* main already sets this inline; keep for robustness */
  flex-direction: column;
  align-items: center;         /* centers children that are narrower than the parent */
}

/* actual sections: limit width and center */
.section,
.secondary-page,
#mainContentArea > .section,
#secondaryPagesContainer > .secondary-page {
  width: 100%;
  max-width: var(--max-content-width);
  box-sizing: border-box;
  margin: 0 auto;             /* extra safety if parent is not a flex centering container */
  padding: 18px 12px;         /* tweak spacing if you want */
}
